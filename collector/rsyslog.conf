# rsyslog configuration file

# Modules
module(load="imudp")
module(load="imtcp")

# UDP Syslog reception
input(type="imudp" port="514")

# TCP Syslog reception
input(type="imtcp" port="514")

# JSON template for log formatting
template(name="json-template"
         type="list"
         option.json="on") {
           constant(value="{")
           constant(value="\"timestamp\":\"")     property(name="timereported" dateFormat="rfc3339")
           constant(value="\",\"source\":\"")     property(name="hostname")
           constant(value="\",\"facility\":\"")   property(name="syslogfacility-text")
           constant(value="\",\"severity\":\"")   property(name="syslogseverity-text")
           constant(value="\",\"tag\":\"")        property(name="syslogtag" format="json")
           constant(value="\",\"message\":\"")    property(name="msg" format="json")
           constant(value="\"}")
         }

# Write logs to JSON files
*.* /var/log/collector/%$YEAR%%$MONTH%%$DAY%.json;json-template
