title: Test Rule - Suspicious PowerShell Encoded Command
id: test-rule-001
status: experimental
description: Detects PowerShell execution with encoded commands, which is commonly used by malicious scripts
author: SIEMBox Test
date: 2025/04/09
modified: 2025/04/09
logsource:
  category: process_creation
  product: windows
detection:
  selection:
    process|contains:
      - 'powershell'
      - 'pwsh'
    commandline|contains:
      - '-enc'
      - '-encodedcommand'
      - '-e'
      - '-ec'
  condition: selection
falsepositives:
  - Legitimate PowerShell scripts using encoded commands
level: medium
tags:
  - attack.execution
  - attack.t1059.001